# 솔루션

## 통과한 코드

```mysql
SET @TOTAL = 0;
SELECT @TOTAL := COUNT(USER_ID) AS TOTAL FROM USER_INFO WHERE YEAR(JOINED) = 2021;

SELECT 
    YEAR(OS.SALES_DATE), 
    MONTH(OS.SALES_DATE),
    COUNT(DISTINCT OS.USER_ID) AS PUCHASED_USERS,
    ROUND(COUNT(DISTINCT OS.USER_ID) / @TOTAL,1) AS PUCHASED_RATIO
FROM USER_INFO AS UI 
JOIN ONLINE_SALE AS OS ON UI.USER_ID = OS.USER_ID 
WHERE YEAR(UI.JOINED) = 2021
GROUP BY YEAR(OS.SALES_DATE), MONTH(OS.SALES_DATE)
ORDER BY YEAR(OS.SALES_DATE), MONTH(OS.SALES_DATE);
```

## 풀이 해설

전체 회원 수를 미리 변수에 담아 놓고 활용했습니다.
회원이 ONLINE_SALE에서 중복이 있다는 것이 중요한 포인트였습니다.

## 부족한 점

```mysql
SELECT 
    YEAR(OS.SALES_DATE), 
    MONTH(OS.SALES_DATE),
    COUNT(DISTINCT OS.USER_ID) AS PUCHASED_USERS,
    ROUND(COUNT(DISTINCT OS.USER_ID) / (SELECT COUNT(DISTINCT USER_ID) FROM USER_INFO WHERE YEAR(JOINED) = 2021),1) AS PUCHASED_RATIO
FROM USER_INFO AS UI
JOIN ONLINE_SALE AS OS ON UI.USER_ID = OS.USER_ID 
WHERE YEAR(UI.JOINED) = 2021
GROUP BY YEAR(OS.SALES_DATE), MONTH(OS.SALES_DATE)
ORDER BY YEAR(OS.SALES_DATE), MONTH(OS.SALES_DATE);
```

위와 같이 서브쿼리를 사용해서 풀어도 됩니다.